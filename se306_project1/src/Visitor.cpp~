#include "Visitor.h"
#include "ros/ros.h"
#include "math.h"

/**
*	@brief Visit the resident.
*	May be simple - e.g. toggling visitor visibility, or moving to the door.
*	@returns true if this has moved next to the Resident
*/
bool Visitor::visitResident(se306_project1::ResidentMsg msg) {
	double distanceFromCheckpoint = sqrt(pow((msg.currentCheckpointX - px),2) + pow((msg.currentCheckpointY - py),2));

	move(msg.currentCheckpoint);
	if (distanceFromCheckpoint < 5) {
		stopMoving();
        return true;
    }
	return false;
}

/**
*	@brief Initiates conversation with the resident.
*	@returns true if the behaviour completes successfully.
*/
bool Visitor::doConverse() {
	// converse for an hour?
	int tnow = ros::Time::now().toSec(); // The simulation time now
	int finishConvo = tnow + 1; // one hour later
	
	ROS_INFO("Starting conversation...");
	while (tnow < finishConvo) {
		tnow = ros::Time::now().toSec(); // The simulation time now
	}

	// convo should be done and visitor should leave
	// move(outsideHouse);
	finishedConvo = true;
	
	return finishedConvo;
}
